<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>é¢„çº¦ç®¡ç† - StudySpace ç®¡ç†åå°</title>
  <link rel="stylesheet" href="../../../core/styles/main.css">
  <link rel="stylesheet" href="../../../core/layouts/admin-layout/style.css">
  <link rel="stylesheet" href="../../../core/components/sidebar/style.css">
  <link rel="stylesheet" href="../../../core/components/navbar/style.css">
  <link rel="stylesheet" href="../../../core/components/search-bar/style.css">
  <link rel="stylesheet" href="../../../core/components/filter-dropdown/style.css">
  <link rel="stylesheet" href="../../../core/components/data-card/style.css">
  <link rel="stylesheet" href="../../../core/components/button/style.css">
  <link rel="stylesheet" href="../../../core/components/toast/style.css">
  <link rel="stylesheet" href="../../../core/components/modal/style.css">
  <link rel="stylesheet" href="../styles/overview.css">
</head>
<body>
  <div class="admin-layout">
    <!-- ä¾§è¾¹æ  - æ¯›ç»ç’ƒæ•ˆæœ -->
    <aside class="sidebar">
      <div class="sidebar__logo">
        <span class="sidebar__logo-text">StudySpace</span>
      </div>
      <nav class="sidebar__nav">
        <a href="overview.html" class="sidebar__nav-item sidebar__nav-item--active" data-page="dashboard">
          <span class="sidebar__nav-text">ğŸ“Š é¢„çº¦ç®¡ç†</span>
        </a>
        <a href="../../seat-management/pages/seat-list.html" class="sidebar__nav-item" data-page="seat-management">
          <span class="sidebar__nav-text">ğŸ’º åº§ä½ç®¡ç†</span>
        </a>
        <a href="../../study-record/pages/index.html" class="sidebar__nav-item" data-page="study-record">
          <span class="sidebar__nav-text">ğŸ“š å­¦ä¹ è®°å½•</span>
        </a>
        <a href="../../user-management/pages/index.html" class="sidebar__nav-item" data-page="user-management">
          <span class="sidebar__nav-text">ğŸ‘¥ ç”¨æˆ·ç®¡ç†</span>
        </a>
        <a href="../../announcement/pages/index.html" class="sidebar__nav-item" data-page="announcement">
          <span class="sidebar__nav-text">ğŸ“¢ å…¬å‘Šé€šçŸ¥</span>
        </a>
        <a href="../../settings/pages/index.html" class="sidebar__nav-item" data-page="settings">
          <span class="sidebar__nav-text">âš™ï¸ ç®¡ç†å‘˜è®¾ç½®</span>
        </a>
      </nav>
      
      <!-- ä¾§è¾¹æ åº•éƒ¨ç”¨æˆ·åŒºåŸŸ -->
      <div class="sidebar__footer">
        <div class="sidebar__user" id="userBtn">
          <div class="sidebar__user-avatar">ç®¡</div>
          <div class="sidebar__user-info">
            <span class="sidebar__user-name">ç®¡ç†å‘˜</span>
            <span class="sidebar__user-role">è¶…çº§ç®¡ç†å‘˜</span>
          </div>
          <span class="sidebar__user-menu">â–¼</span>
        </div>
        <!-- ç”¨æˆ·ä¸‹æ‹‰èœå• -->
        <div class="user-dropdown" id="userDropdown">
          <div class="user-dropdown__item">ğŸ‘¤ ä¸ªäººä¿¡æ¯</div>
          <div class="user-dropdown__item">ğŸ” ä¿®æ”¹å¯†ç </div>
          <div class="user-dropdown__item">âš™ï¸ ç³»ç»Ÿè®¾ç½®</div>
          <div class="user-dropdown__divider"></div>
          <div class="user-dropdown__item user-dropdown__item--danger" id="logoutBtn">ğŸšª é€€å‡ºç™»å½•</div>
        </div>
      </div>
    </aside>

    <!-- ä¸»å†…å®¹åŒº -->
    <div class="admin-layout__main">
      <!-- é¡¶éƒ¨å¯¼èˆª - æ¯›ç»ç’ƒæ•ˆæœ -->
      <header class="navbar navbar--fixed">
        <div class="search-bar">
          <input type="text" class="search-bar__input" placeholder="æœç´¢åŠŸèƒ½ã€ç”¨æˆ·ã€åº§ä½...">
          <button class="search-bar__btn" title="æœç´¢">æœç´¢</button>
        </div>
        <div class="navbar__right">
          <span class="navbar__time" id="currentTime"></span>
          <button class="navbar__notification">
            ğŸ””
            <span class="navbar__notification-badge"></span>
          </button>
          <button class="navbar__filter-btn">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
              <path d="M1.5 1.5A.5.5 0 0 1 2 1h12a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-.128.334L10 8.692V13.5a.5.5 0 0 1-.342.474l-3 1A.5.5 0 0 1 6 14.5V8.692L1.628 3.834A.5.5 0 0 1 1.5 3.5v-2z"/>
            </svg>
            ç­›é€‰
          </button>
        </div>
      </header>

      <!-- é¡µé¢å†…å®¹ -->
      <main class="admin-layout__content">
        <!-- ç­›é€‰åŒºåŸŸ -->
        <div class="filter-bar">
          <div class="filter-dropdown" id="floorDropdown">
            <button class="filter-dropdown__trigger" onclick="toggleDropdown('floorDropdown')">
              <span class="filter-dropdown__label">æ¥¼å±‚ 1</span>
              <span class="filter-dropdown__arrow">â–¾</span>
            </button>
            <div class="filter-dropdown__menu">
              <div class="filter-dropdown__item filter-dropdown__item--active">æ¥¼å±‚ 1</div>
              <div class="filter-dropdown__item">æ¥¼å±‚ 2</div>
              <div class="filter-dropdown__item">æ¥¼å±‚ 3</div>
            </div>
          </div>
          <div class="filter-dropdown" id="areaDropdown">
            <button class="filter-dropdown__trigger" onclick="toggleDropdown('areaDropdown')">
              <span class="filter-dropdown__label">åŒºåŸŸ A</span>
              <span class="filter-dropdown__arrow">â–¾</span>
            </button>
            <div class="filter-dropdown__menu">
              <div class="filter-dropdown__item filter-dropdown__item--active">åŒºåŸŸ A</div>
              <div class="filter-dropdown__item">åŒºåŸŸ B</div>
              <div class="filter-dropdown__item">åŒºåŸŸ C</div>
            </div>
          </div>
          <div class="date-picker">
            <input type="text" class="date-picker__input" value="2025/11/29" readonly>
            <span class="date-picker__icon">ğŸ“…</span>
          </div>
        </div>

        <!-- æ•°æ®å¡ç‰‡åŒºåŸŸ - å¸¦å…¥åœºåŠ¨ç”» -->
        <div class="stats-grid">
          <div class="data-card">
            <div class="data-card__header">
              <span class="data-card__title">æ€»ç”¨æˆ·æ•°</span>
              <span class="data-card__icon">ğŸ‘¥</span>
            </div>
            <div class="data-card__value">1,234</div>
            <div class="data-card__footer">
              <span class="data-card__trend data-card__trend--up">â†‘ 12%</span>
              <span class="data-card__desc">è¾ƒä¸Šå‘¨</span>
            </div>
          </div>
          <div class="data-card">
            <div class="data-card__header">
              <span class="data-card__title">åº§ä½æ€»æ•°</span>
              <span class="data-card__icon">ğŸ’º</span>
            </div>
            <div class="data-card__value">500</div>
            <div class="data-card__footer">
              <span class="data-card__desc">å¯ç”¨åº§ä½</span>
            </div>
          </div>
          <div class="data-card">
            <div class="data-card__header">
              <span class="data-card__title">ä»Šæ—¥é¢„çº¦</span>
              <span class="data-card__icon">ğŸ“‹</span>
            </div>
            <div class="data-card__value">89</div>
            <div class="data-card__footer">
              <span class="data-card__trend data-card__trend--up">â†‘ 8%</span>
              <span class="data-card__desc">è¾ƒæ˜¨æ—¥</span>
            </div>
          </div>
          <div class="data-card">
            <div class="data-card__header">
              <span class="data-card__title">è¿çº¦äººæ¬¡</span>
              <span class="data-card__icon">âš ï¸</span>
            </div>
            <div class="data-card__value">12</div>
            <div class="data-card__footer">
              <span class="data-card__trend data-card__trend--down">â†“ 5%</span>
              <span class="data-card__desc">è¾ƒä¸Šå‘¨</span>
            </div>
          </div>
        </div>

        <!-- å®æ—¶åº§ä½ä½¿ç”¨æƒ…å†µ -->
        <div class="content-card">
          <div class="content-card__header">
            <span class="content-card__title">å®æ—¶åº§ä½ä½¿ç”¨æƒ…å†µ</span>
            <div class="usage-stats">
              <span class="usage-stats__item"><span class="usage-stats__dot usage-stats__dot--used"></span>å·²ä½¿ç”¨ 378</span>
              <span class="usage-stats__item"><span class="usage-stats__dot usage-stats__dot--available"></span>å¯ç”¨ 122</span>
            </div>
          </div>
          <div class="usage-bar">
            <div class="usage-bar__fill" style="width: 75.6%;">
              <span class="usage-bar__label">75.6%</span>
            </div>
          </div>
          <div class="usage-details">
            <div class="usage-detail">
              <div class="usage-detail__header">
                <span class="usage-detail__label">AåŒº</span>
                <span class="usage-detail__value">82%</span>
              </div>
              <div class="usage-detail__bar"><div class="usage-detail__fill" style="width: 82%;"></div></div>
            </div>
            <div class="usage-detail">
              <div class="usage-detail__header">
                <span class="usage-detail__label">BåŒº</span>
                <span class="usage-detail__value">68%</span>
              </div>
              <div class="usage-detail__bar"><div class="usage-detail__fill" style="width: 68%;"></div></div>
            </div>
            <div class="usage-detail">
              <div class="usage-detail__header">
                <span class="usage-detail__label">CåŒº</span>
                <span class="usage-detail__value">71%</span>
              </div>
              <div class="usage-detail__bar"><div class="usage-detail__fill" style="width: 71%;"></div></div>
            </div>
          </div>
        </div>

        <!-- ä¸¤åˆ—å¸ƒå±€ï¼šé¢„çº¦è¶‹åŠ¿ + ä»Šæ—¥é¢„çº¦æ—¶æ®µ -->
        <div class="dashboard-grid">
          <div class="content-card">
            <div class="content-card__header">
              <span class="content-card__title">æœ¬å‘¨é¢„çº¦è¶‹åŠ¿</span>
              <div class="content-card__actions">
                <button class="chart-btn chart-btn--active">æŒ‰å¤©</button>
                <button class="chart-btn">æŒ‰å‘¨</button>
              </div>
            </div>
            <canvas id="trendChart" style="width: 100%; height: 220px;"></canvas>
          </div>
          
          <div class="content-card">
            <div class="content-card__header">
              <span class="content-card__title">ä»Šæ—¥é¢„çº¦æ—¶æ®µåˆ†å¸ƒ</span>
            </div>
            <div class="time-slots">
              <div class="time-slot">
                <span class="time-slot__time">08:00-10:00</span>
                <div class="time-slot__bar"><div class="time-slot__fill" style="width: 45%;"></div></div>
                <span class="time-slot__count">18äºº</span>
              </div>
              <div class="time-slot">
                <span class="time-slot__time">10:00-12:00</span>
                <div class="time-slot__bar"><div class="time-slot__fill time-slot__fill--high" style="width: 85%;"></div></div>
                <span class="time-slot__count">34äºº</span>
              </div>
              <div class="time-slot">
                <span class="time-slot__time">12:00-14:00</span>
                <div class="time-slot__bar"><div class="time-slot__fill" style="width: 35%;"></div></div>
                <span class="time-slot__count">14äºº</span>
              </div>
              <div class="time-slot">
                <span class="time-slot__time">14:00-16:00</span>
                <div class="time-slot__bar"><div class="time-slot__fill time-slot__fill--high" style="width: 92%;"></div></div>
                <span class="time-slot__count">37äºº</span>
              </div>
              <div class="time-slot">
                <span class="time-slot__time">16:00-18:00</span>
                <div class="time-slot__bar"><div class="time-slot__fill time-slot__fill--high" style="width: 78%;"></div></div>
                <span class="time-slot__count">31äºº</span>
              </div>
              <div class="time-slot">
                <span class="time-slot__time">18:00-20:00</span>
                <div class="time-slot__bar"><div class="time-slot__fill" style="width: 55%;"></div></div>
                <span class="time-slot__count">22äºº</span>
              </div>
              <div class="time-slot">
                <span class="time-slot__time">20:00-22:00</span>
                <div class="time-slot__bar"><div class="time-slot__fill" style="width: 28%;"></div></div>
                <span class="time-slot__count">11äºº</span>
              </div>
            </div>
          </div>
        </div>

        <!-- é¢„çº¦ä¸è¿çº¦è®°å½• -->
        <div class="content-card">
          <div class="content-card__header">
            <span class="content-card__title">æœ€æ–°é¢„çº¦è®°å½•</span>
            <button class="btn btn--text btn--sm" onclick="viewAllReservations()">æŸ¥çœ‹å…¨éƒ¨ â†’</button>
          </div>
          <table class="records-table">
            <thead>
              <tr>
                <th>å­¦ç”Ÿ</th>
                <th>åº§ä½</th>
                <th>é¢„çº¦æ—¶æ®µ</th>
                <th>çŠ¶æ€</th>
                <th>æ“ä½œ</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>
                  <div class="user-info">
                    <div class="user-info__avatar">å¼ </div>
                    <div class="user-info__detail">
                      <span class="user-info__name">å¼ æ™“æ˜</span>
                      <span class="user-info__id">2021112573</span>
                    </div>
                  </div>
                </td>
                <td><span class="seat-tag">A-12</span></td>
                <td>14:00 - 18:00</td>
                <td><span class="status-tag status-tag--active">ä½¿ç”¨ä¸­</span></td>
                <td><button class="action-link">è¯¦æƒ…</button></td>
              </tr>
              <tr>
                <td>
                  <div class="user-info">
                    <div class="user-info__avatar">æ</div>
                    <div class="user-info__detail">
                      <span class="user-info__name">ææ€é›¨</span>
                      <span class="user-info__id">2022115847</span>
                    </div>
                  </div>
                </td>
                <td><span class="seat-tag">B-08</span></td>
                <td>09:00 - 12:00</td>
                <td><span class="status-tag status-tag--completed">å·²å®Œæˆ</span></td>
                <td><button class="action-link">è¯¦æƒ…</button></td>
              </tr>
              <tr>
                <td>
                  <div class="user-info">
                    <div class="user-info__avatar">ç‹</div>
                    <div class="user-info__detail">
                      <span class="user-info__name">ç‹æµ©ç„¶</span>
                      <span class="user-info__id">2021113264</span>
                    </div>
                  </div>
                </td>
                <td><span class="seat-tag">A-15</span></td>
                <td>16:00 - 20:00</td>
                <td><span class="status-tag status-tag--pending">å¾…ç­¾åˆ°</span></td>
                <td><button class="action-link">è¯¦æƒ…</button></td>
              </tr>
              <tr>
                <td>
                  <div class="user-info">
                    <div class="user-info__avatar">èµµ</div>
                    <div class="user-info__detail">
                      <span class="user-info__name">èµµæ¬£æ€¡</span>
                      <span class="user-info__id">2020114892</span>
                    </div>
                  </div>
                </td>
                <td><span class="seat-tag">C-05</span></td>
                <td>10:00 - 12:00</td>
                <td><span class="status-tag status-tag--violation">æœªç­¾åˆ°</span></td>
                <td><button class="action-link">å¤„ç†</button></td>
              </tr>
              <tr>
                <td>
                  <div class="user-info">
                    <div class="user-info__avatar">é’±</div>
                    <div class="user-info__detail">
                      <span class="user-info__name">é’±å®‡è½©</span>
                      <span class="user-info__id">2022116235</span>
                    </div>
                  </div>
                </td>
                <td><span class="seat-tag">A-20</span></td>
                <td>14:00 - 17:00</td>
                <td><span class="status-tag status-tag--active">ä½¿ç”¨ä¸­</span></td>
                <td><button class="action-link">è¯¦æƒ…</button></td>
              </tr>
            </tbody>
          </table>
        </div>
      </main>
    </div>
  </div>

  <script src="../../../core/utils/dom.js"></script>
  <script src="../../../core/utils/helpers.js"></script>
  <script src="../../../core/components/toast/toast.js"></script>
  <script src="../../../core/components/modal/modal.js"></script>
  <script src="../../../core/utils/interactions.js"></script>
  <script>
    // ä¸‹æ‹‰æ¡†äº¤äº’
    function toggleDropdown(id) {
      const dropdown = document.getElementById(id);
      const isOpen = dropdown.classList.contains('filter-dropdown--open');
      
      // å…³é—­æ‰€æœ‰ä¸‹æ‹‰æ¡†
      document.querySelectorAll('.filter-dropdown').forEach(d => {
        d.classList.remove('filter-dropdown--open');
      });
      
      // åˆ‡æ¢å½“å‰ä¸‹æ‹‰æ¡†
      if (!isOpen) {
        dropdown.classList.add('filter-dropdown--open');
      }
    }
    
    // ç‚¹å‡»å¤–éƒ¨å…³é—­ä¸‹æ‹‰æ¡†
    document.addEventListener('click', (e) => {
      if (!e.target.closest('.filter-dropdown')) {
        document.querySelectorAll('.filter-dropdown').forEach(d => {
          d.classList.remove('filter-dropdown--open');
        });
      }
    });
    
    // é€‰æ‹©ä¸‹æ‹‰é¡¹
    document.querySelectorAll('.filter-dropdown__item').forEach(item => {
      item.addEventListener('click', function() {
        const dropdown = this.closest('.filter-dropdown');
        const label = dropdown.querySelector('.filter-dropdown__label');
        
        // æ›´æ–°é€‰ä¸­çŠ¶æ€
        dropdown.querySelectorAll('.filter-dropdown__item').forEach(i => {
          i.classList.remove('filter-dropdown__item--active');
        });
        this.classList.add('filter-dropdown__item--active');
        
        // æ›´æ–°æ˜¾ç¤ºæ–‡æœ¬
        label.textContent = this.textContent;
        
        // å…³é—­ä¸‹æ‹‰æ¡†
        dropdown.classList.remove('filter-dropdown--open');
      });
    });

    // ç»˜åˆ¶é¢„çº¦è¶‹åŠ¿å›¾è¡¨
    function drawTrendChart() {
      const canvas = document.getElementById('trendChart');
      if (!canvas) return;
      const ctx = canvas.getContext('2d');
      
      const dpr = window.devicePixelRatio || 1;
      const rect = canvas.getBoundingClientRect();
      canvas.width = rect.width * dpr;
      canvas.height = rect.height * dpr;
      ctx.scale(dpr, dpr);
      
      const width = rect.width;
      const height = rect.height;
      const padding = { top: 30, right: 20, bottom: 35, left: 40 };
      const chartWidth = width - padding.left - padding.right;
      const chartHeight = height - padding.top - padding.bottom;
      
      const days = ['å‘¨ä¸€', 'å‘¨äºŒ', 'å‘¨ä¸‰', 'å‘¨å››', 'å‘¨äº”', 'å‘¨å…­', 'å‘¨æ—¥'];
      const data = [72, 85, 78, 92, 89, 65, 58];
      const maxValue = 100;
      
      ctx.clearRect(0, 0, width, height);
      
      // ç»˜åˆ¶ç½‘æ ¼çº¿
      ctx.strokeStyle = 'rgba(0, 0, 0, 0.05)';
      ctx.lineWidth = 1;
      ctx.font = '11px -apple-system, BlinkMacSystemFont, sans-serif';
      ctx.fillStyle = '#86868B';
      ctx.textAlign = 'right';
      
      for (let i = 0; i <= 4; i++) {
        const y = padding.top + (chartHeight / 4) * i;
        const value = maxValue - (maxValue / 4) * i;
        ctx.beginPath();
        ctx.moveTo(padding.left, y);
        ctx.lineTo(padding.left + chartWidth, y);
        ctx.stroke();
        ctx.fillText(value, padding.left - 8, y + 4);
      }
      
      // ç»˜åˆ¶Xè½´æ ‡ç­¾
      ctx.textAlign = 'center';
      const barWidth = chartWidth / days.length;
      days.forEach((day, i) => {
        ctx.fillText(day, padding.left + barWidth * i + barWidth / 2, height - 10);
      });
      
      // ç»˜åˆ¶æŸ±çŠ¶å›¾
      data.forEach((value, i) => {
        const barHeight = (value / maxValue) * chartHeight;
        const x = padding.left + barWidth * i;
        const y = padding.top + chartHeight - barHeight;
        const actualBarWidth = barWidth * 0.5;
        const barX = x + (barWidth - actualBarWidth) / 2;
        
        const gradient = ctx.createLinearGradient(barX, y, barX, y + barHeight);
        gradient.addColorStop(0, '#007AFF');
        gradient.addColorStop(1, '#5AC8FA');
        
        ctx.fillStyle = gradient;
        ctx.beginPath();
        const radius = 4;
        ctx.moveTo(barX + radius, y);
        ctx.lineTo(barX + actualBarWidth - radius, y);
        ctx.quadraticCurveTo(barX + actualBarWidth, y, barX + actualBarWidth, y + radius);
        ctx.lineTo(barX + actualBarWidth, y + barHeight);
        ctx.lineTo(barX, y + barHeight);
        ctx.lineTo(barX, y + radius);
        ctx.quadraticCurveTo(barX, y, barX + radius, y);
        ctx.closePath();
        ctx.fill();
      });
    }
    
    window.addEventListener('load', drawTrendChart);
    window.addEventListener('resize', drawTrendChart);

    // ç”¨æˆ·ä¸‹æ‹‰èœå•
    const userBtn = document.getElementById('userBtn');
    const userDropdown = document.getElementById('userDropdown');
    const logoutBtn = document.getElementById('logoutBtn');

    userBtn?.addEventListener('click', (e) => {
      e.stopPropagation();
      userDropdown.classList.toggle('show');
    });

    document.addEventListener('click', (e) => {
      if (!e.target.closest('.sidebar__footer')) {
        userDropdown?.classList.remove('show');
      }
    });

    logoutBtn?.addEventListener('click', () => {
      if (confirm('ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿ')) {
        window.location.href = '../../../pages/login.html';
      }
    });

    // æ˜¾ç¤ºå½“å‰æ—¶é—´
    function updateTime() {
      const now = new Date();
      const options = { 
        month: 'short', 
        day: 'numeric',
        weekday: 'short',
        hour: '2-digit', 
        minute: '2-digit'
      };
      const timeEl = document.getElementById('currentTime');
      if (timeEl) {
        timeEl.textContent = now.toLocaleString('zh-CN', options);
      }
    }
    updateTime();
    setInterval(updateTime, 60000);

    // ========== é€šç”¨äº¤äº’å‡½æ•° ==========
    
    // Toast æç¤º
    function showToast(message, type = 'info') {
      const existing = document.querySelector('.toast');
      if (existing) existing.remove();
      
      const toast = document.createElement('div');
      toast.className = `toast toast--${type}`;
      toast.innerHTML = `<span>${message}</span>`;
      toast.style.cssText = `
        position: fixed;
        top: 80px;
        left: 50%;
        transform: translateX(-50%);
        padding: 12px 24px;
        background: ${type === 'success' ? '#34C759' : type === 'error' ? '#FF3B30' : '#007AFF'};
        color: white;
        border-radius: 12px;
        font-size: 14px;
        font-weight: 500;
        box-shadow: 0 4px 20px rgba(0,0,0,0.15);
        z-index: 9999;
        animation: toastIn 0.3s ease;
      `;
      document.body.appendChild(toast);
      
      setTimeout(() => {
        toast.style.animation = 'toastOut 0.3s ease forwards';
        setTimeout(() => toast.remove(), 300);
      }, 2500);
    }

    // æ·»åŠ  Toast åŠ¨ç”»æ ·å¼
    const toastStyle = document.createElement('style');
    toastStyle.textContent = `
      @keyframes toastIn {
        from { opacity: 0; transform: translateX(-50%) translateY(-20px); }
        to { opacity: 1; transform: translateX(-50%) translateY(0); }
      }
      @keyframes toastOut {
        from { opacity: 1; transform: translateX(-50%) translateY(0); }
        to { opacity: 0; transform: translateX(-50%) translateY(-20px); }
      }
    `;
    document.head.appendChild(toastStyle);

    // ========== æœç´¢æ¡†äº¤äº’ ==========
    const searchInput = document.querySelector('.search-bar__input');
    searchInput?.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') {
        const query = e.target.value.trim();
        if (query) {
          showToast(`æ­£åœ¨æœç´¢: "${query}"`, 'info');
          // æ¨¡æ‹Ÿæœç´¢
          setTimeout(() => {
            showToast(`æ‰¾åˆ° ${Math.floor(Math.random() * 20) + 1} æ¡ç›¸å…³ç»“æœ`, 'success');
          }, 800);
        }
      }
    });

    // ========== é€šçŸ¥æŒ‰é’®äº¤äº’ ==========
    document.querySelector('.navbar__notification')?.addEventListener('click', () => {
      showToast('æ‚¨æœ‰ 3 æ¡æœªè¯»é€šçŸ¥', 'info');
    });

    // ========== ç­›é€‰æŒ‰é’®äº¤äº’ ==========
    document.querySelector('.navbar__filter-btn')?.addEventListener('click', () => {
      showToast('ç­›é€‰é¢æ¿å·²æ‰“å¼€', 'info');
    });

    // ========== å›¾è¡¨åˆ‡æ¢æŒ‰é’® ==========
    document.querySelectorAll('.chart-btn').forEach(btn => {
      btn.addEventListener('click', function() {
        const parent = this.closest('.content-card__actions');
        parent.querySelectorAll('.chart-btn').forEach(b => b.classList.remove('chart-btn--active'));
        this.classList.add('chart-btn--active');
        showToast(`å·²åˆ‡æ¢åˆ°${this.textContent}è§†å›¾`, 'success');
        // é‡ç»˜å›¾è¡¨
        drawTrendChart();
      });
    });

    // ========== æŸ¥çœ‹å…¨éƒ¨æŒ‰é’® ==========
    document.querySelectorAll('.btn--text').forEach(btn => {
      btn.addEventListener('click', () => {
        showToast('æ­£åœ¨åŠ è½½å®Œæ•´åˆ—è¡¨...', 'info');
      });
    });

    // ========== è¡¨æ ¼æ“ä½œæŒ‰é’® ==========
    document.querySelectorAll('.action-link').forEach(btn => {
      btn.addEventListener('click', function() {
        const row = this.closest('tr');
        const userName = row.querySelector('.user-info__name')?.textContent || 'ç”¨æˆ·';
        const action = this.textContent;
        
        if (action === 'å¤„ç†') {
          if (confirm(`ç¡®å®šè¦å¤„ç† ${userName} çš„è¿çº¦è®°å½•å—ï¼Ÿ`)) {
            showToast(`å·²å¤„ç† ${userName} çš„è¿çº¦è®°å½•`, 'success');
            // æ›´æ–°çŠ¶æ€æ ‡ç­¾
            const statusTag = row.querySelector('.status-tag');
            if (statusTag) {
              statusTag.textContent = 'å·²å¤„ç†';
              statusTag.className = 'status-tag status-tag--completed';
            }
            this.textContent = 'è¯¦æƒ…';
          }
        } else {
          showToast(`æ­£åœ¨æŸ¥çœ‹ ${userName} çš„è¯¦ç»†ä¿¡æ¯...`, 'info');
        }
      });
    });

    // ========== æ•°æ®å¡ç‰‡ç‚¹å‡» ==========
    document.querySelectorAll('.data-card').forEach(card => {
      card.style.cursor = 'pointer';
      card.addEventListener('click', function() {
        const title = this.querySelector('.data-card__title')?.textContent;
        showToast(`æ­£åœ¨æŸ¥çœ‹${title}è¯¦æƒ…...`, 'info');
      });
    });

    // ========== æ—¥æœŸé€‰æ‹©å™¨ ==========
    document.querySelector('.date-picker')?.addEventListener('click', function() {
      const input = this.querySelector('.date-picker__input');
      // ç®€å•çš„æ—¥æœŸåˆ‡æ¢æ¼”ç¤º
      const dates = ['2025/11/29', '2025/11/30', '2025/12/01', '2025/12/02'];
      const currentIndex = dates.indexOf(input.value);
      const nextIndex = (currentIndex + 1) % dates.length;
      input.value = dates[nextIndex];
      showToast(`å·²åˆ‡æ¢åˆ° ${dates[nextIndex]}`, 'success');
    });

    // ========== ç”¨æˆ·ä¸‹æ‹‰èœå•é¡¹äº¤äº’ ==========
    document.querySelectorAll('.user-dropdown__item:not(.user-dropdown__item--danger)').forEach(item => {
      item.addEventListener('click', function() {
        const text = this.textContent.trim();
        if (text.includes('ä¸ªäººä¿¡æ¯')) {
          showToast('æ­£åœ¨æ‰“å¼€ä¸ªäººä¿¡æ¯...', 'info');
        } else if (text.includes('ä¿®æ”¹å¯†ç ')) {
          showToast('æ­£åœ¨æ‰“å¼€ä¿®æ”¹å¯†ç ...', 'info');
        } else if (text.includes('ç³»ç»Ÿè®¾ç½®')) {
          window.location.href = '../../settings/pages/index.html';
        }
        userDropdown.classList.remove('show');
      });
    });

    // ========== åº§ä½ä½¿ç”¨ç‡åŒºåŸŸç‚¹å‡» ==========
    document.querySelectorAll('.usage-detail').forEach(detail => {
      detail.style.cursor = 'pointer';
      detail.addEventListener('click', function() {
        const area = this.querySelector('.usage-detail__label')?.textContent;
        showToast(`æ­£åœ¨æŸ¥çœ‹${area}è¯¦ç»†åº§ä½æƒ…å†µ...`, 'info');
      });
    });

    // ========== æ—¶æ®µåˆ†å¸ƒç‚¹å‡» ==========
    document.querySelectorAll('.time-slot').forEach(slot => {
      slot.style.cursor = 'pointer';
      slot.addEventListener('click', function() {
        const time = this.querySelector('.time-slot__time')?.textContent;
        const count = this.querySelector('.time-slot__count')?.textContent;
        showToast(`${time} æ—¶æ®µå…±æœ‰ ${count} é¢„çº¦`, 'info');
      });
    });

    // ========== è¡¨æ ¼è¡Œæ‚¬åœæ•ˆæœ ==========
    document.querySelectorAll('.records-table tbody tr').forEach(row => {
      row.style.cursor = 'pointer';
      row.addEventListener('click', function(e) {
        if (!e.target.closest('.action-link')) {
          const userName = this.querySelector('.user-info__name')?.textContent;
          showToast(`æ­£åœ¨æŸ¥çœ‹ ${userName} çš„é¢„çº¦è¯¦æƒ…...`, 'info');
        }
      });
    });

    // ========== é¡µé¢åŠŸèƒ½ ==========
    function viewAllReservations() {
      Toast.info('æ­£åœ¨è·³è½¬åˆ°é¢„çº¦ç®¡ç†é¡µé¢...');
      setTimeout(() => {
        window.location.href = '../../user-management/pages/index.html';
      }, 500);
    }

    // é€šçŸ¥æŒ‰é’®ç‚¹å‡»
    document.querySelector('.navbar__notification')?.addEventListener('click', () => {
      Toast.info('æš‚æ— æ–°é€šçŸ¥');
    });
  </script>

  <!-- Toast ç»„ä»¶ -->
  <script src="../../../core/components/toast/toast.js"></script>
</body>
</html>