<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
  <title>StudySpace - 邮箱找回密码</title>
  <link rel="stylesheet" href="../desktop/admin-desktop/core/styles/main.css">
  <style>
    :root {
      --auth-bg: radial-gradient(circle at 18% 22%, rgba(0, 122, 255, 0.12), transparent 34%),
        radial-gradient(circle at 78% 18%, rgba(90, 200, 250, 0.12), transparent 36%),
        radial-gradient(circle at 50% 82%, rgba(0, 122, 255, 0.08), transparent 38%),
        linear-gradient(180deg, #F2F3F7 0%, #E7E9F2 100%);
    }

    body {
      margin: 0;
      min-height: 100vh;
      font-family: var(--font-family-primary);
      background: var(--auth-bg);
      color: var(--color-text-primary);
      display: flex;
      justify-content: center;
      padding: 22px 14px 26px;
    }

    .page {
      width: min(390px, 100%);
      display: flex;
      flex-direction: column;
      gap: var(--spacing-md);
      min-height: calc(100vh - 60px);
    }

    .phone-shell {
      background: rgba(255, 255, 255, 0.9);
      border: 1px solid var(--color-border-secondary);
      border-radius: 46px;
      padding: 18px 16px 22px;
      box-shadow: var(--shadow-xl);
      backdrop-filter: var(--glass-blur);
      -webkit-backdrop-filter: var(--glass-blur);
      min-height: 780px;
      display: grid;
      gap: var(--spacing-md);
    }

    .card-header {
      display: flex;
      align-items: center;
      gap: var(--spacing-sm);
      padding: 8px 12px;
      border: 1px solid var(--color-border-secondary);
      border-radius: var(--radius-lg);
      background: linear-gradient(135deg, #F8FBFF 0%, #F1F6FF 60%, #FFFFFF 100%);
      box-shadow: var(--shadow-sm);
      font-weight: var(--font-weight-semibold);
    }

    .brand-logo { width: 42px; height: 42px; border-radius: 50%; background: var(--color-primary-gradient); display: grid; place-items: center; color: #fff; font-weight: var(--font-weight-bold); box-shadow: var(--shadow-lg); }
    .brand-title { display: flex; flex-direction: column; gap: 2px; }
    .brand-title strong { font-size: 18px; letter-spacing: var(--letter-spacing-tight); }
    .brand-title span { color: var(--color-text-secondary); font-size: 13px; }

    .panel {
      background: var(--glass-bg-dark);
      border: 1px solid var(--color-border-secondary);
      border-radius: var(--radius-xxl);
      padding: 18px 16px 20px;
      box-shadow: var(--shadow-lg);
      display: grid;
      gap: var(--spacing-md);
    }

    .panel h2 { margin: 0; text-align: center; font-size: 18px; letter-spacing: var(--letter-spacing-tight); }

    .form-grid { display: grid; gap: var(--spacing-sm); }
    .field { display: grid; gap: 6px; }
    .field label { font-size: 14px; font-weight: var(--font-weight-semibold); }
    .input { width: 100%; padding: 10px 12px; border-radius: var(--radius-lg); border: 1px solid var(--color-border-secondary); background: rgba(255,255,255,0.94); font-size: 15px; transition: border-color var(--transition-normal), box-shadow var(--transition-normal); }
    .input:focus { outline: none; border-color: var(--color-primary); box-shadow: 0 0 0 4px rgba(0,122,255,0.18); }

    .captcha-row { display: flex; gap: var(--spacing-sm); align-items: center; }
    .captcha-row .input { flex: 1; }

    .btn-ghost { border: 1px solid var(--color-border-secondary); background: rgba(255,255,255,0.9); border-radius: var(--radius-md); padding: 10px 12px; font-size: 14px; cursor: pointer; transition: transform var(--transition-bounce), box-shadow var(--transition-normal), border-color var(--transition-normal); white-space: nowrap; }
    .btn-ghost:hover { transform: translateY(-1px); border-color: var(--color-primary); box-shadow: var(--shadow-sm); }

    .form-message { display: none; border-radius: var(--radius-lg); padding: var(--spacing-sm) var(--spacing-md); font-size: 14px; justify-content: center; align-items: center; gap: var(--spacing-sm); }
    .form-message--success { display: flex; background: var(--color-success-bg); color: var(--color-success); border: 1px solid rgba(52, 199, 89, 0.2); }
    .form-message--error { display: flex; background: var(--color-error-bg); color: var(--color-error); border: 1px solid rgba(255,59,48,0.2); }

    .actions { display: grid; gap: var(--spacing-sm); }
    .btn-primary { border: none; background: var(--color-primary-gradient); color: #fff; padding: 14px 18px; border-radius: var(--radius-lg); font-size: 16px; font-weight: var(--font-weight-semibold); cursor: pointer; box-shadow: var(--shadow-button); transition: transform var(--transition-bounce), box-shadow var(--transition-normal); width: 100%; }
    .btn-primary:hover { transform: translateY(-1px); box-shadow: var(--shadow-card-hover); }

    .link-button { border: 1px solid var(--color-border-secondary); background: rgba(255, 255, 255, 0.92); color: var(--color-text-primary); padding: 12px 14px; border-radius: var(--radius-lg); font-weight: var(--font-weight-semibold); cursor: pointer; transition: border-color var(--transition-normal), box-shadow var(--transition-normal); width: 100%; }
    .link-button:hover { border-color: var(--color-primary); box-shadow: var(--shadow-sm); }

    @media (max-width: 480px) {
      body { padding: 20px 12px; }
      .phone-shell { padding: 14px 12px 18px; border-radius: 46px; min-height: 600px; }
    }
  </style>
</head>
<body>
  <div class="page">
    <div class="phone-shell">
      <div class="card-header" aria-label="邮箱找回密码标题">
        <div class="brand-logo">SS</div>
        <div class="brand-title">
          <strong>StudySpace 找回密码</strong>
          <span>邮箱验证码重设密码</span>
        </div>
      </div>

      <section class="panel" aria-label="邮箱找回密码表单">
        <h2>邮箱找回密码</h2>
        <form class="form-grid" id="emailResetForm">
          <div class="field">
            <label for="email">邮箱账号</label>
            <input id="email" class="input" type="email" name="email" placeholder="请输入注册邮箱" autocomplete="email" required>
          </div>
          <div class="field">
            <label for="captcha">验证码</label>
            <div class="captcha-row">
              <input id="captcha" class="input" type="text" name="captcha" placeholder="请输入邮箱验证码" autocomplete="one-time-code" required>
              <button class="btn-ghost" type="button" id="sendCodeBtn">获取验证码</button>
            </div>
          </div>
          <div class="field">
            <label for="newPassword">新密码</label>
            <input id="newPassword" class="input" type="password" name="newPassword" placeholder="至少 6 位字符" autocomplete="new-password" required>
          </div>
          <div class="form-message" id="formMessage" aria-live="polite"></div>
          <div class="actions">
            <button class="btn-primary" type="submit" id="resetBtn">提交并重设</button>
            <button class="link-button" type="button" onclick="window.location.href='移动用户端-登录.html'">返回登录</button>
          </div>
        </form>
      </section>
    </div>
  </div>

  <script>
    const form = document.querySelector('#emailResetForm');
    const formMessage = document.querySelector('#formMessage');
    const sendCodeBtn = document.querySelector('#sendCodeBtn');
    const resetBtn = document.querySelector('#resetBtn');

    function showMessage(text, type = 'error') {
      formMessage.textContent = text;
      formMessage.classList.remove('form-message--error', 'form-message--success');
      formMessage.classList.add(type === 'success' ? 'form-message--success' : 'form-message--error');
      formMessage.style.display = 'flex';
    }

    function clearMessage() {
      formMessage.textContent = '';
      formMessage.classList.remove('form-message--error', 'form-message--success');
      formMessage.style.display = 'none';
    }

    function goTo(path) {
      window.location.href = path;
    }

    sendCodeBtn?.addEventListener('click', () => {
      const email = document.querySelector('#email').value.trim();
      if (!email) {
        showMessage('请先填写邮箱再获取验证码');
        return;
      }
      let countdown = 60;
      sendCodeBtn.disabled = true;
      sendCodeBtn.textContent = `重新获取(${countdown}s)`;
      const timer = setInterval(() => {
        countdown -= 1;
        sendCodeBtn.textContent = countdown > 0 ? `重新获取(${countdown}s)` : '获取验证码';
        if (countdown <= 0) {
          clearInterval(timer);
          sendCodeBtn.disabled = false;
        }
      }, 1000);
      showMessage('验证码已发送至邮箱，请注意查收', 'success');
    });

    form?.addEventListener('submit', (e) => {
      e.preventDefault();
      clearMessage();
      const email = document.querySelector('#email').value.trim();
      const captcha = document.querySelector('#captcha').value.trim();
      const newPassword = document.querySelector('#newPassword').value.trim();
      if (!email || !captcha || !newPassword) {
        showMessage('请完整填写邮箱、验证码和新密码');
        return;
      }
      if (newPassword.length < 6) {
        showMessage('新密码长度不足，请至少输入 6 位');
        return;
      }
      resetBtn.disabled = true;
      resetBtn.textContent = '提交中...';
      setTimeout(() => {
        showMessage('重置成功，正在返回登录页...', 'success');
        setTimeout(() => goTo('移动用户端-登录.html'), 700);
        resetBtn.disabled = false;
        resetBtn.textContent = '提交并重设';
      }, 800);
    });
  </script>
</body>
</html>
